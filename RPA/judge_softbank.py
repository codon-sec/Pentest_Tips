# 使い方 import judge_softbank
# 対応フォーマット pdf,xlsx,docs
import os.path

import docx
import pandas as pd
import PyPDF2

FILE_PATH = "/Users/yoshio/Desktop/hoge.xlsx"
keyword = "SoftBank"
root, ext = os.path.splitext(FILE_PATH)


def main(FILE_PATH):
    # ファイル形式を判別する
    if ext == ".pdf":
        if read_pdf(FILE_PATH) is True:
            return True
    elif ext == ".xlsx":
        if read_xlsx(FILE_PATH) is True:
            return True
    elif ext == ".docx":
        if read_docs(FILE_PATH) is True:
            return True
    return False


def read_pdf(FILE_PATH):
    with open(FILE_PATH, "rb") as f:
        reader = PyPDF2.PdfFileReader(f)
        # 暗号化PDFはパスワードが必要なため検査不可
        if reader.isEncrypted:
            return False
        for i in range(reader.getNumPages()):
            page = reader.getPage(i)
            page_text = page.extractText()
            print(page_text)
            if keyword in page_text:
                return True


def read_xlsx(FILE_PATH):
    excel_data = pd.read_excel(FILE_PATH)
    # データが入力されている行で特定の文字列がないか検査
    excel_data = []
    for i in excel_data:
        excel_data.append(i.text)
    if keyword in excel_data:
        return True
    return False


def read_docs(FILE_PATH):
    doc = docx.Document(FILE_PATH)
    # wordから文書を取得
    for word in doc.paragraphs:
        if keyword in word.text:
            return True
    return False


if __name__ == '__main__':
    main()
