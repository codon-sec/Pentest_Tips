# 使い方 import judge_softbank
# 対応フォーマット pdf,xlsx,docs
import os.path

import docx
import pandas as pd
import PyPDF2

FILE_PATH = ""
keyword = ""


def main(FILE_PATH, keyword):
    # ファイル形式を判別
    root, ext = os.path.splitext(FILE_PATH)
    if ext == ".pdf":
        if read_pdf(FILE_PATH) is True:
            return True
    elif ext == ".xlsx":
        if read_xlsx(FILE_PATH) is True:
            return True
    elif ext == ".docx":
        if read_docs(FILE_PATH) is True:
            return True
    return False


def read_pdf(FILE_PATH):
    with open(FILE_PATH, "rb") as f:
        reader = PyPDF2.PdfFileReader(f)
        # 暗号化PDFは検査不可
        if reader.isEncrypted:
            return False
        for i in range(reader.getNumPages()):
            page = reader.getPage(i)
            page_text = page.extractText()
            if keyword in page_text:
                return True


def read_xlsx(FILE_PATH):
    with open(FILE_PATH, "rb") as f:
        excel_data = pd.read_excel(f)
        for keyword in excel_data:
            if keyword in keyword:
                return True
        return False


def read_docs(FILE_PATH):
    with open(FILE_PATH, "rb") as f:
        doc = docx.Document(f)
        for word in doc.paragraphs:
            if keyword in word.text:
                return True
        return False


if __name__ == '__main__':
    main(FILE_PATH, keyword)
